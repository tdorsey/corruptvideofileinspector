# Corrupt Video Inspector

A Docker-based tool to detect and report corrupt video files using FFmpeg.

## Quick Start

This project was generated by the `setup_and_run.sh` script and includes everything needed to run in Docker.

### Usage

**Scan videos in a directory:**
```bash
./run.sh scan /path/to/your/videos
```

**List videos only:**
```bash
./run.sh list /path/to/your/videos
```

**Interactive mode:**
```bash
./run.sh interactive /path/to/your/videos
```

### Direct Python Usage

**Install the package:**
```bash
pip install -e .
```

**Run a scan:**
```bash
python3 cli_handler.py /path/to/your/videos
corrupt-video-inspector /path/to/your/videos
```

### Direct Docker Usage

**Build the image:**
```bash
docker build -t corrupt-video-inspector .
```

**Run a scan:**
```bash
docker run --rm \
  -v /path/to/your/videos:/app/videos:ro \
  -v $(pwd)/output:/app/output \
  corrupt-video-inspector \
  python3 cli_handler.py --verbose --json /app/videos
```

### Development

**Install development dependencies:**
```bash
pip install -e ".[dev]"
```

**Run formatting and linting:**
```bash
make format  # Format code with black
make lint    # Lint code with ruff
make type    # Type check with mypy
make check   # Run all checks
```

**Run tests:**
```bash
make test    # Run integration tests
```

**Or manually:**
```bash
black .
ruff check .
mypy .
python3 tests/run_tests.py  # Run integration tests
```

### Features

- Multi-threaded video processing
- FFmpeg-based corruption detection
- JSON output with detailed results
- Resume functionality for interrupted scans
- Recursive directory scanning
- File extension filtering
- Progress tracking
- Comprehensive integration testing

### Output

Results are saved to the `output` directory:
- Console output with summary
- JSON file with detailed results (if --json flag used)
- Progress tracking during scan

### Supported Formats

- MP4, AVI, MKV, MOV, WMV, FLV, WebM, M4V, MPG, MPEG, 3GP, ASF

## Project Structure

```
├── cli_handler.py      # Main CLI entry point
├── video_inspector.py  # Core video inspection logic
├── utils.py           # Utility functions
├── tests/             # Integration tests
│   ├── test_utils_integration.py
│   ├── test_video_inspector_integration.py
│   ├── test_cli_integration.py
│   ├── test_end_to_end_integration.py
│   ├── run_tests.py   # Test runner
│   └── README.md      # Test documentation
├── pyproject.toml     # Modern Python packaging and tool configuration
├── Dockerfile         # Docker container configuration
└── README.md          # This file
```

## Requirements

- Python 3.8+
- FFmpeg (automatically included in Docker image)
